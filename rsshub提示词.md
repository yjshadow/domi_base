# RSShub 订阅源功能模块代码生成提示词

## 1. 项目背景

本项目旨在实现一个RSShub订阅源功能模块，该模块将实现对订阅源返回文章的提纯、翻译、缓存，并在所有操作结束后将数据插入数据库。此外，还将涵盖定时任务的异常处理机制。

## 2. 功能需求

### 2.1 订阅源管理

- **订阅源生成**：通过RSShub生成指定网站的RSS订阅源。
- **订阅源维护**：允许用户手动添加、编辑和删除订阅源。

### 2.2 文章提纯

- **内容过滤**：根据用户需求过滤文章标题、描述、作者和时间等。
- **格式化处理**：将文章格式化为统一的格式，便于后续处理。

### 2.3 文章翻译

- **自动翻译**：集成翻译API（如谷歌翻译），实现文章内容的自动翻译。
- **语言选择**：允许用户选择翻译的语言。

### 2.4 缓存机制

- **缓存策略**：使用缓存（如Redis）存储已处理的文章，减少重复处理。
- **缓存失效策略**：设定缓存有效期，定期更新缓存内容。

### 2.5 数据存储

- **数据库插入**：将处理后的文章数据插入数据库，支持批量插入。
- **数据格式**：确保插入数据库的数据格式符合设计规范。

### 2.6 定时任务

- **任务调度**：设定定时任务，定期执行文章抓取、处理、翻译和存储流程。
- **异常处理**：在定时任务执行过程中加入异常处理机制，确保任务稳定性。

## 3. 技术要求

### 3.1 依赖技术

- **编程语言**：Java/Python
- **框架**：Spring Boot（Java）/Flask/Django（Python）
- **数据库**：MySQL/PostgreSQL
- **缓存**：Redis
- **翻译API**：谷歌翻译API或其他第三方翻译服务

### 3.2 部署环境

- **本地开发环境**：支持Docker容器化部署。
- **生产环境**：支持云服务部署，具备高可用性。

## 4. 异常处理

### 4.1 异常类型

- **任务执行超时**：定时任务执行时间超过设定阈值。
- **任务执行失败**：任务执行过程中出现错误。
- **数据库连接异常**：数据库连接失败或中断。

### 4.2 异常处理策略

- **异常捕获**：在任务执行代码中加入try-catch块，捕获异常。
- **重试机制**：对于可恢复的异常，设置重试策略，如指数退避。
- **错误记录**：记录异常日志，便于后续分析和排查。
- **报警通知**：在异常发生时，通过邮件、短信等方式通知相关人员。

## 5. 数据库设计

### 5.1 数据表结构

- **订阅源表**（Subscriptions）
  - id (主键)
  - url (订阅源URL)
  - name (订阅源名称)
  - created_at (创建时间)
  - updated_at (更新时间)

- **文章表**（Articles）
  - id (主键)
  - title (文章标题)
  - content (文章内容)
  - source_url (来源URL)
  - translated_content (翻译内容)
  - cache_time (缓存时间)
  - status (状态)
  - created_at (创建时间)
  - updated_at (更新时间)

## 6. 定时任务设计

### 6.1 任务调度

- **任务周期**：根据需求设定，如每天、每小时等。
- **任务执行逻辑**：
  1. 从RSShub获取订阅源数据。
  2. 对数据进行处理和翻译。
  3. 将处理后的数据存入缓存。
  4. 将数据插入数据库。

### 6.2 异常处理逻辑

- **任务超时处理**：设定任务执行超时时间，超时后终止任务并重试。
- **任务失败处理**：记录任务失败日志，并根据配置进行重试或报警。

## 7. 总结

本文档详细描述了RSShub订阅源功能模块的需求，包括功能需求、技术要求、异常处理及数据库设计等。通过实现该模块，将有效提升内容管理的效率和准确性。
